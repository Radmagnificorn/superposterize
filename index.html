<!doctype html>
<html>
<head>
    <title>Super Posterizer</title>
    <script src="./superposterizer.js" defer></script>
    <link rel="stylesheet" href="./superposterizer.css">
</head>
    <body>
        <div class="tabs">
            <div role="tablist" aria-label="Apps" class="tablist">
                <button role="tab" aria-selected="true" aria-controls="posterizer-panel" id="posterizer-tab">Posterizer</button>
                <button role="tab" aria-selected="false" aria-controls="newapp-panel" id="newapp-tab" tabindex="-1">Pixel art normalizer</button>
            </div>

            <section id="posterizer-panel" role="tabpanel" aria-labelledby="posterizer-tab">
                <input id="fileSelect" type="file"/>
                <button id="resetButton">Reset</button>
                <button id="downloadImage">Download</button>
                <button id='testButton'>Posterize</button>
                H Step: <input type="number" id="hSplit" min="0" max="1" value="0.01">
                S Step: <input type="number" id="sSplit" min="0" max="0.5" value="0.01" step="0.01">
                <label for="toggleGuy">Toggle Guy: </label>
                <input type="checkbox" name="toggleGuy" id="toggleGuy">
                Scale: <input type="number" id="scale" value="1">
                <canvas id="imageDisplay"></canvas>
                <div id="valueControls">
                    <label for="margin">Margin: </label>
                    <input type="number" id="margin" name="margin" min="0" max="1" value="0">
                    
                    <input type="range" class="valueSlider" min="0" max="1" step="0.05" value="0.1">
                    <input type="range" class="valueSlider" min="0" max="1" step="0.05" value="0.2">
                    <input type="range" class="valueSlider" min="0" max="1" step="0.05" value="0.5">
                    <input type="range" class="valueSlider" min="0" max="1" step="0.05" value="0.8">
                    <input type="range" class="valueSlider" min="0" max="1" step="0.05" value="0.9">
                    
                </div>
                <img id="sampleCharacter" src="./samplecharacter.png"/>
            </section>

            <section id="newapp-panel" role="tabpanel" aria-labelledby="newapp-tab" hidden>
                <div class="new-app">
                    <h2>Pixel Art Normalizer</h2>
                    <input id="aiFileSelect" type="file" accept="image/*" />
                    <button id="normalizeButton">Analyze + Normalize</button>
                    <label for="normScale">Display Scale: </label>
                    <input type="number" id="normScale" value="8" min="1" step="1" />
                    <label style="margin-left:12px"><input type="checkbox" id="autoDetect" checked /> Auto-detect grid</label>
                    <label for="blockW">Block W:</label>
                    <input type="number" id="blockW" value="8" min="1" step="1" disabled />
                    <label for="blockH">Block H:</label>
                    <input type="number" id="blockH" value="8" min="1" step="1" disabled />
                    <button id="downloadNormalized">Download Normalized</button>
                    <div id="analysisInfo" aria-live="polite" style="margin:8px 0;color:#555"></div>
                    <canvas id="normalizedCanvas" aria-label="Normalized pixel art output"></canvas>
                </div>
            </section>
        </div>

        <script>
        (function() {
            const tabs = document.querySelectorAll('[role="tab"]');
            const panels = document.querySelectorAll('[role="tabpanel"]');

            function activateTab(tab) {
                tabs.forEach(t => {
                    const selected = t === tab;
                    t.setAttribute('aria-selected', selected);
                    t.setAttribute('tabindex', selected ? '0' : '-1');
                });
                panels.forEach(p => {
                    p.hidden = (p.id !== tab.getAttribute('aria-controls'));
                });
                tab.focus();
            }

            tabs.forEach(t => {
                t.addEventListener('click', () => activateTab(t));
                t.addEventListener('keydown', (e) => {
                    const currentIndex = Array.prototype.indexOf.call(tabs, document.activeElement);
                    if (e.key === 'ArrowRight') { e.preventDefault(); activateTab(tabs[(currentIndex + 1) % tabs.length]); }
                    if (e.key === 'ArrowLeft') { e.preventDefault(); activateTab(tabs[(currentIndex - 1 + tabs.length) % tabs.length]); }
                });
            });
        })();
        </script>
    </body>
</html>